<div class="card">
  <h3>Programmes disponibles</h3>

  <input
    type="text"
    [(ngModel)]="searchText"
    placeholder="Rechercher un programme..."
    class="form-control search-bar"
  />

  <div class="button-row">
    <!-- üü¶ Extraction de donn√©es -->
    <button (click)="extractData()" [disabled]="isLoading" class="extract-data-btn">
      {{ isLoading ? 'Extraction en cours...' : 'Extraire les donn√©es' }}
    </button>

    <!-- üîß Ajout d‚Äôun filtre personnalis√© pour les donn√©es -->
    <button (click)="showDataFilter = true" class="data-filter-btn">
      Ajouter un filtre personnalis√©
    </button>

    <!-- üü© Extraction de programmes -->
    <button (click)="extractPrograms()" [disabled]="isLoading" class="extract-prog-btn">
      {{ isLoading ? 'Extraction en cours...' : 'Extraire les programmes' }}
    </button>

    <!-- üîÑ Mise √† jour de la liste des programmes -->
    <button (click)="showProgramFilter = true" [disabled]="isLoading" class="maj_prgrm-btn">
      {{ isLoading ? 'Mise √† jour...' : 'Mettre √† jour la liste des programmes' }}
    </button>
  </div>

  <!-- üåê Fen√™tre filtre donn√©es -->
  <app-frontend-filter
    *ngIf="showDataFilter"
    (apply)="onDataFilterApplied($event)"
    (close)="showDataFilter = false">
  </app-frontend-filter>

  <!-- üß≠ Fen√™tre filtre programmes -->
  <app-program-extraction-filter
    *ngIf="showProgramFilter"
    (apply)="onProgramFilterApplied($event)"
    (close)="showProgramFilter = false">
  </app-program-extraction-filter>
</div>

<p>{{ message }}</p>

<table class="programmes-table">
  <thead>
    <tr>
      <th>
        <input
          type="checkbox"
          [(ngModel)]="allSelected"
          (change)="toggleAll()"
        />
        Tout s√©lectionner
      </th>
      <th>Programme</th>
      <th>Libell√©</th>
      <th>Date de d√©but</th>
      <th>√âtat</th>
      <th>Responsables</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let prog of filteredProgrammes">
      <td>
        <input type="checkbox" [(ngModel)]="prog.checked" name="{{ prog.name }}" />
      </td>
      <td>{{ prog.name }}</td>
      <td>{{ prog.libelle }}</td>
      <td>{{ prog.startDate || '' }}</td>
      <td>{{ prog.etat || '' }}</td>
      <td>{{ prog.responsable || '' }}</td>
    </tr>
  </tbody>
</table>

<!-- üìä Fichiers CSV des programmes -->
<app-extracted-links [files]="extractedProgramFiles"></app-extracted-links>

<!-- üì¶ Fichiers ZIP des donn√©es -->
<app-extracted-links [files]="extractedDataFiles"></app-extracted-links>

<!-- üîÅ Bouton relancer le filtrage seul -->
<button (click)="relancerFiltrageSeul()" [disabled]="isLoading" class="maj_prgrm-btn">
  {{ isLoading ? 'Filtrage...' : 'Relancer uniquement le filtrage' }}
</button>
